import { calculateTransforms } from './calculate-transforms';
import { drawElement } from './draw-element';
import { handle3dTransform } from './handle-3d-transform';
export const drawElementToCanvas = async ({ element, context, draw, offsetLeft, offsetTop, logLevel, parentRect, }) => {
    const transforms = calculateTransforms({ element, offsetLeft, offsetTop });
    const { totalMatrix, reset, dimensions, opacity, computedStyle } = transforms;
    if (opacity === 0) {
        reset();
        return 'continue';
    }
    if (dimensions.width <= 0 || dimensions.height <= 0) {
        reset();
        return 'continue';
    }
    if (!totalMatrix.is2D) {
        await handle3dTransform({
            element,
            totalMatrix,
            parentRect,
            context,
            logLevel,
        });
        reset();
        return 'skip-children';
    }
    await drawElement({
        dimensions: new DOMRect(dimensions.left - offsetLeft, dimensions.top - offsetTop, dimensions.width, dimensions.height),
        computedStyle,
        context,
        draw,
        opacity,
        totalMatrix,
    });
    reset();
    return 'continue';
};
